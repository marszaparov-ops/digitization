<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π –ê—Ä—Ö–∏–≤</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background-color: #f0f2f5; display: flex; height: 100vh; overflow: hidden; }
        .sidebar { width: 250px; background: #2c3e50; color: white; display: flex; flex-direction: column; }
        .sidebar-header { padding: 20px; background: #1a252f; text-align: center; font-weight: bold; }
        .nav-menu { flex: 1; padding: 10px 0; }
        .nav-item { padding: 15px 25px; display: flex; align-items: center; gap: 12px; color: #bdc3c7; text-decoration: none; border-left: 4px solid transparent; }
        .nav-item:hover, .nav-item.active { background: #34495e; color: white; border-left: 4px solid #2196F3; }
        .content-area { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
        .top-bar { background: white; padding: 15px 30px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .main-content { padding: 25px; flex: 1; display: flex; flex-direction: column; overflow: hidden; }
        .table-container { flex: 1; overflow-y: auto; background: white; border-radius: 8px; border: 1px solid #ddd; }
        table { width: 100%; border-collapse: collapse; }
        thead th { position: sticky; top: 0; background: #2196F3; color: white; padding: 12px; text-align: left; }
        td { padding: 10px; border-bottom: 1px solid #eee; }
        .btn { padding: 8px 16px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; text-decoration: none; display: inline-block; }
        .btn-add { background: #4CAF50; color: white; margin-bottom: 15px; }
        .modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); }
        .modal-content { background: white; margin: 5% auto; padding: 25px; width: 400px; border-radius: 10px; }
        input, select { width: 100%; padding: 8px; margin: 5px 0 15px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }
    </style>
</head>
<body>
<div class="sidebar">
    <div class="sidebar-header">üì¶ –°–ò–°–¢–ï–ú–ê –ê–†–•–ò–í</div>
    <div class="nav-menu">
        <a th:href="@{/archive}" class="nav-item" th:classappend="${section == 'documents'} ? 'active'">üìÑ –î–æ–∫—É–º–µ–Ω—Ç—ã</a>
        <a th:href="@{/archive/history}" class="nav-item" th:classappend="${section == 'history'} ? 'active'">üóÑÔ∏è –ê—Ä—Ö–∏–≤</a>
        <a th:href="@{/archive/users}" class="nav-item" th:classappend="${section == 'users'} ? 'active'">üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</a>
    </div>
</div>

<div class="content-area">
    <div class="top-bar">
        <h3 th:text="${section == 'documents' ? '–†–µ–µ—Å—Ç—Ä –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤' : (section == 'history' ? '–ò—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π' : '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–æ–º')}"></h3>
        <div><span th:text="${#authentication.name}"></span> | <a th:href="@{/logout}" style="color:red">–í—ã—Ö–æ–¥</a></div>
    </div>

    <div class="main-content">
        <div th:if="${section == 'documents'}">
            <button class="btn btn-add" onclick="toggleModal('docModal', true)">+ –ù–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç</button>
            <div class="table-container">
                <table>
                    <thead><tr><th>ID</th><th>‚Ññ –î–æ–∫.</th><th>–ù–∞–∑–≤–∞–Ω–∏–µ</th><th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th></tr></thead>
                    <tbody><tr th:each="d : ${documents}"><td th:text="${d.id}"></td><td th:text="${d.docNumber}"></td><td th:text="${d.title}"></td><td th:text="${d.category}"></td></tr></tbody>
                </table>
            </div>
        </div>

        <div th:if="${section == 'history'}">
            <div class="table-container">
                <table>
                    <thead><tr><th>–î–∞—Ç–∞</th><th>–Æ–∑–µ—Ä</th><th>–î–µ–π—Å—Ç–≤–∏–µ</th><th>–ò–Ω—Ñ–æ</th></tr></thead>
                    <tbody><tr th:each="l : ${logs}"><td th:text="${l.getFormattedDate()}"></td><td th:text="${l.username}"></td><td th:text="${l.action}"></td><td th:text="${l.details}"></td></tr></tbody>
                </table>
            </div>
        </div>

        <div th:if="${section == 'users'}">
            <button class="btn btn-add" onclick="toggleModal('userModal', true)">+ –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</button>
            <div class="table-container">
                <table>
                    <thead><tr><th>ID</th><th>–õ–æ–≥–∏–Ω</th><th>–†–æ–ª—å</th><th>–°—Ç–∞—Ç—É—Å</th></tr></thead>
                    <tbody><tr th:each="u : ${users}"><td th:text="${u.id}"></td><td th:text="${u.username}"></td><td th:text="${u.role}"></td><td>–ê–∫—Ç–∏–≤–µ–Ω</td></tr></tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div id="userModal" class="modal">
    <div class="modal-content">
        <h3>–ù–æ–≤—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫</h3>
        <form th:action="@{/archive/users/add}" method="post">
            <label>–õ–æ–≥–∏–Ω</label><input type="text" name="username" required>
            <label>–ü–∞—Ä–æ–ª—å</label><input type="password" name="password" required>
            <label>–†–æ–ª—å</label>
            <select name="role"><option value="ROLE_USER">USER</option><option value="ROLE_ADMIN">ADMIN</option></select>
            <button type="submit" class="btn btn-add" style="width:100%">–°–æ–∑–¥–∞—Ç—å</button>
            <button type="button" onclick="toggleModal('userModal', false)" style="width:100%; background:#ccc; margin-top:5px" class="btn">–û—Ç–º–µ–Ω–∞</button>
        </form>
    </div>
</div>

<script>function toggleModal(id, show) { document.getElementById(id).style.display = show ? 'block' : 'none'; }</script>
</body>
</html>