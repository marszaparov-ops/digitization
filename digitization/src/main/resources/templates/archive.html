<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>–¶–∏—Ñ—Ä–æ–≤–æ–π –ê—Ä—Ö–∏–≤ | –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background-color: #f0f2f5; display: flex; height: 100vh; overflow: hidden; }

        /* –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å (Sidebar) */
        .sidebar { width: 250px; background: #2c3e50; color: white; display: flex; flex-direction: column; box-shadow: 2px 0 5px rgba(0,0,0,0.1); }
        .sidebar-header { padding: 20px; background: #1a252f; text-align: center; font-size: 1.2em; font-weight: bold; }

        .nav-menu { flex: 1; padding: 10px 0; }
        .nav-item {
            padding: 15px 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            color: #bdc3c7;
            text-decoration: none;
            transition: 0.3s;
            border-left: 4px solid transparent;
        }
        .nav-item:hover { background: #34495e; color: white; border-left: 4px solid #2196F3; }
        .nav-item.active { background: #34495e; color: white; border-left: 4px solid #2196F3; }

        /* –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å (—Å–ø—Ä–∞–≤–∞) */
        .content-area { flex: 1; display: flex; flex-direction: column; overflow: hidden; }

        /* –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å –≤ –∫–æ–Ω—Ç–µ–Ω—Ç–µ */
        .top-bar {
            background: white;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            z-index: 10;
        }

        /* –ö–æ–Ω—Ç–µ–Ω—Ç–Ω–∞—è —á–∞—Å—Ç—å */
        .main-content { padding: 25px; flex: 1; display: flex; flex-direction: column; overflow: hidden; }

        /* –¢–∞–±–ª–∏—Ü–∞ —Å –ø–æ–ª–∑—É–Ω–∫–æ–º */
        .table-container {
            flex: 1;
            overflow-y: auto;
            background: white;
            border-radius: 8px;
            border: 1px solid #ddd;
        }

        table { width: 100%; border-collapse: collapse; }
        thead th { position: sticky; top: 0; background: #2196F3; color: white; padding: 15px; text-align: left; z-index: 2; }
        td { padding: 12px; border-bottom: 1px solid #eee; }
        tr:hover { background: #f1f4f6; }

        /* –ö–Ω–æ–ø–∫–∏ –∏ –ø—Ä–æ—á–µ–µ */
        .btn { padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; transition: 0.3s; text-decoration: none; display: inline-block; }
        .btn-add { background: #4CAF50; color: white; margin-bottom: 15px; }
        .btn-delete { background: #f44336; color: white; padding: 5px 10px; font-size: 0.8em; }

        /* –ü–∞–≥–∏–Ω–∞—Ü–∏—è */
        .pagination { display: flex; justify-content: center; list-style: none; padding: 15px 0; gap: 5px; }
        .page-link { padding: 8px 16px; text-decoration: none; color: #2196F3; background: white; border: 1px solid #ddd; border-radius: 4px; }
        .active .page-link { background: #2196F3; color: white; }

        /* –ú–æ–¥–∞–ª–∫–∏ */
        .modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); }
        .modal-content { background: white; margin: 5% auto; padding: 25px; width: 450px; border-radius: 10px; }
    </style>
</head>
<body>

<div class="sidebar">
    <div class="sidebar-header">üì¶ –ê–†–•–ò–í –°–ò–°–¢–ï–ú–ê</div>
    <div class="nav-menu">
        <a href="#" class="nav-item"><span>üìÑ</span> –î–æ–∫—É–º–µ–Ω—Ç—ã</a>
        <a href="/archive" class="nav-item active"><span>üóÑÔ∏è</span> –ê—Ä—Ö–∏–≤</a>
        <a href="#" class="nav-item"><span>üë•</span> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</a>
        <a href="#" class="nav-item"><span>üìö</span> –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫</a>
    </div>
    <div style="padding: 20px; font-size: 0.8em; color: #7f8c8d; border-top: 1px solid #34495e;">
        –í–µ—Ä—Å–∏—è 1.0.2
    </div>
</div>

<div class="content-area">

    <div class="top-bar">
        <h3 style="margin:0;">–†–∞–∑–¥–µ–ª: –≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤</h3>
        <div style="display: flex; align-items: center; gap: 15px;">
            <span style="font-weight: bold; color: #34495e;" sec:authentication="name">User</span>
            <a href="/logout" class="btn" style="background: #e74c3c; color: white; padding: 5px 15px;">–í—ã—Ö–æ–¥</a>
        </div>
    </div>

    <div class="main-content">
        <div>
            <button class="btn btn-add" onclick="toggleModal('uploadModal', true)">+ –î–æ–±–∞–≤–∏—Ç—å –≤ –∞—Ä—Ö–∏–≤</button>
        </div>

        <div class="table-container">
            <table>
                <thead>
                <tr>
                    <th>ID</th>
                    <th>‚Ññ –î–æ–∫.</th>
                    <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                    <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                    <th sec:authorize="hasRole('ADMIN')">–î–µ–π—Å—Ç–≤–∏–µ</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="doc : ${documents}">
                    <td th:text="${doc.id}"></td>
                    <td th:text="${doc.docNumber}"></td>
                    <td>
                        <a href="javascript:void(0);" th:onclick="'showPreview(\'/archive/download/' + ${doc.id} + '\')'"
                           th:text="${doc.title}" style="color: #2196F3; text-decoration: none; font-weight: bold;"></a>
                    </td>
                    <td th:text="${doc.category}"></td>
                    <td sec:authorize="hasRole('ADMIN')">
                        <form th:action="@{/archive/delete/{id}(id=${doc.id})}" method="post">
                            <button class="btn btn-delete" onclick="return confirm('–£–¥–∞–ª–∏—Ç—å?');">–£–¥–∞–ª–∏—Ç—å</button>
                        </form>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <nav th:if="${totalPages > 1}">
            <ul class="pagination">
                <li th:classappend="${currentPage == 0} ? 'disabled'"><a class="page-link" th:href="@{/archive(page=${currentPage - 1})}">–ù–∞–∑–∞–¥</a></li>
                <li th:each="i : ${#numbers.sequence(0, totalPages - 1)}" th:classappend="${currentPage == i} ? 'active'">
                    <a class="page-link" th:href="@{/archive(page=${i})}" th:text="${i + 1}"></a>
                </li>
                <li th:classappend="${currentPage == totalPages - 1} ? 'disabled'"><a class="page-link" th:href="@{/archive(page=${currentPage + 1})}">–í–ø–µ—Ä–µ–¥</a></li>
            </ul>
        </nav>
    </div>
</div>

<div id="uploadModal" class="modal">
    <div class="modal-content">
        <h3>–ù–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç</h3>
        <form th:action="@{/archive/upload}" method="post" enctype="multipart/form-data">
            <div style="margin-bottom:15px;"><label style="display:block; font-weight:bold;">–ù–∞–∑–≤–∞–Ω–∏–µ</label><input type="text" name="title" style="width:100%; padding:8px;" required></div>
            <div style="margin-bottom:15px;"><label style="display:block; font-weight:bold;">–ù–æ–º–µ—Ä</label><input type="text" name="docNumber" style="width:100%; padding:8px;"></div>
            <div style="margin-bottom:15px;">
                <label style="display:block; font-weight:bold;">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                <select name="category" style="width:100%; padding:8px;">
                    <option value="–î–æ–≥–æ–≤–æ—Ä">–î–æ–≥–æ–≤–æ—Ä</option>
                    <option value="–ü—Ä–∏–∫–∞–∑">–ü—Ä–∏–∫–∞–∑</option>
                    <option value="–ü–∏—Å—å–º–æ">–ü–∏—Å—å–º–æ</option>
                </select>
            </div>
            <div style="margin-bottom:15px;"><label style="display:block; font-weight:bold;">–§–∞–π–ª</label><input type="file" name="file"></div>
            <button type="submit" class="btn btn-add" style="width:100%">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            <button type="button" onclick="toggleModal('uploadModal', false)" style="width:100%; background:#ccc; margin-top:5px;" class="btn">–û—Ç–º–µ–Ω–∞</button>
        </form>
    </div>
</div>

<div id="previewModal" class="modal">
    <div class="modal-content" style="width:80%; height:85%; margin: 2% auto;">
        <button onclick="toggleModal('previewModal', false)" style="float:right" class="btn btn-delete">–ó–∞–∫—Ä—ã—Ç—å</button>
        <iframe id="previewFrame" src="" style="width:100%; height:95%; border:none; margin-top:10px;"></iframe>
    </div>
</div>

<script>
    function toggleModal(id, show) { document.getElementById(id).style.display = show ? 'block' : 'none'; }
    function showPreview(url) { document.getElementById('previewFrame').src = url; toggleModal('previewModal', true); }
</script>

</body>
</html>