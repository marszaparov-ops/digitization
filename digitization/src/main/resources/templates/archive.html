<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>–¶–∏—Ñ—Ä–æ–≤–æ–π –ê—Ä—Ö–∏–≤ | –°–∏—Å—Ç–µ–º–∞</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background-color: #f0f2f5; display: flex; height: 100vh; overflow: hidden; }

        /* Sidebar */
        .sidebar { width: 250px; background: #2c3e50; color: white; display: flex; flex-direction: column; box-shadow: 2px 0 5px rgba(0,0,0,0.1); }
        .sidebar-header { padding: 20px; background: #1a252f; text-align: center; font-size: 1.2em; font-weight: bold; }
        .nav-menu { flex: 1; padding: 10px 0; }
        .nav-item { padding: 15px 25px; display: flex; align-items: center; gap: 12px; color: #bdc3c7; text-decoration: none; transition: 0.3s; border-left: 4px solid transparent; }
        .nav-item:hover, .nav-item.active { background: #34495e; color: white; border-left: 4px solid #2196F3; }

        /* Main Content */
        .content-area { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
        .top-bar { background: white; padding: 15px 30px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .main-content { padding: 25px; flex: 1; display: flex; flex-direction: column; overflow: hidden; }

        /* Tables */
        .table-container { flex: 1; overflow-y: auto; background: white; border-radius: 8px; border: 1px solid #ddd; }
        table { width: 100%; border-collapse: collapse; }
        thead th { position: sticky; top: 0; background: #2196F3; color: white; padding: 15px; text-align: left; z-index: 2; }
        td { padding: 12px; border-bottom: 1px solid #eee; }
        tr:hover { background: #f1f4f6; }

        /* UI Elements */
        .btn { padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; transition: 0.3s; text-decoration: none; display: inline-block; }
        .btn-add { background: #4CAF50; color: white; margin-bottom: 15px; }
        .btn-delete { background: #f44336; color: white; padding: 5px 10px; font-size: 0.8em; }
        .modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); }
        .modal-content { background: white; margin: 5% auto; padding: 25px; width: 450px; border-radius: 10px; }
    </style>
</head>
<body>

<div class="sidebar">
    <div class="sidebar-header">üì¶ –ê–†–•–ò–í –°–ò–°–¢–ï–ú–ê</div>
    <div class="nav-menu">
        <a th:href="@{/archive}" class="nav-item" th:classappend="${section == 'documents'} ? 'active'">
            <span>üìÑ</span> –î–æ–∫—É–º–µ–Ω—Ç—ã
        </a>
        <a th:href="@{/archive/history}" class="nav-item" th:classappend="${section == 'history'} ? 'active'">
            <span>üóÑÔ∏è</span> –ê—Ä—Ö–∏–≤
        </a>
        <a th:href="@{/archive/users}" class="nav-item" th:classappend="${section == 'users'} ? 'active'">
            <span>üë•</span> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
        </a>
        <a href="#" class="nav-item"><span>üìö</span> –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫</a>
    </div>
</div>

<div class="content-area">
    <div class="top-bar">
        <h3 style="margin:0;">–¶–∏—Ñ—Ä–æ–≤–æ–π –ê—Ä—Ö–∏–≤ v1.0</h3>
        <div>
            <span style="font-weight:bold;" sec:authentication="name">User</span>
            <a th:href="@{/logout}" style="margin-left:15px; color:#e74c3c; text-decoration:none;">–í—ã—Ö–æ–¥</a>
        </div>
    </div>

    <div class="main-content">
        <div th:if="${section == 'documents'}">
            <button class="btn btn-add" onclick="toggleModal('uploadModal', true)">+ –î–æ–±–∞–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç</button>
        </div>

        <div class="table-container" th:if="${section == 'documents'}">
            <table>
                <thead>
                <tr><th>ID</th><th>‚Ññ –î–æ–∫.</th><th>–ù–∞–∑–≤–∞–Ω–∏–µ</th><th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th><th>–î–µ–π—Å—Ç–≤–∏–µ</th></tr>
                </thead>
                <tbody>
                <tr th:each="doc : ${documents}">
                    <td th:text="${doc.id}"></td>
                    <td th:text="${doc.docNumber}"></td>
                    <td th:text="${doc.title}"></td>
                    <td th:text="${doc.category}"></td>
                    <td>
                        <form th:action="@{/archive/delete/{id}(id=${doc.id})}" method="post">
                            <button class="btn btn-delete" onclick="return confirm('–£–¥–∞–ª–∏—Ç—å?')">–£–¥–∞–ª–∏—Ç—å</button>
                        </form>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <div class="table-container" th:if="${section == 'history'}">
            <table>
                <thead>
                <tr><th>–î–∞—Ç–∞</th><th>–°–æ—Ç—Ä—É–¥–Ω–∏–∫</th><th>–î–µ–π—Å—Ç–≤–∏–µ</th><th>–î–µ—Ç–∞–ª–∏</th></tr>
                </thead>
                <tbody>
                <tr th:each="log : ${logs}">
                    <td th:text="${log.getFormattedDate()}"></td>
                    <td th:text="${log.username}"></td>
                    <td th:text="${log.action}"></td>
                    <td th:text="${log.details}"></td>
                </tr>
                </tbody>
            </table>
        </div>

        <div class="table-container" th:if="${section == 'users'}">
            <table>
                <thead>
                <tr><th>ID</th><th>–õ–æ–≥–∏–Ω</th><th>–†–æ–ª—å</th><th>–°—Ç–∞—Ç—É—Å</th></tr>
                </thead>
                <tbody>
                <tr th:each="user : ${users}">
                    <td th:text="${user.id}"></td>
                    <td th:text="${user.username}"></td>
                    <td th:text="${user.role}"></td>
                    <td>–ê–∫—Ç–∏–≤–µ–Ω</td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<div id="uploadModal" class="modal">
    <div class="modal-content">
        <h3>–ù–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç</h3>
        <form th:action="@{/archive/upload}" method="post" enctype="multipart/form-data">
            <div style="margin-bottom:10px;"><label>–ù–∞–∑–≤–∞–Ω–∏–µ</label><input type="text" name="title" style="width:100%" required></div>
            <div style="margin-bottom:10px;"><label>–ù–æ–º–µ—Ä</label><input type="text" name="docNumber" style="width:100%"></div>
            <div style="margin-bottom:10px;">
                <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                <select name="category" style="width:100%">
                    <option value="–î–æ–≥–æ–≤–æ—Ä">–î–æ–≥–æ–≤–æ—Ä</option>
                    <option value="–ü—Ä–∏–∫–∞–∑">–ü—Ä–∏–∫–∞–∑</option>
                    <option value="–ü–∏—Å—å–º–æ">–ü–∏—Å—å–º–æ</option>
                </select>
            </div>
            <div style="margin-bottom:15px;"><label>–§–∞–π–ª</label><input type="file" name="file" required></div>
            <button type="submit" class="btn btn-add" style="width:100%">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            <button type="button" onclick="toggleModal('uploadModal', false)" style="width:100%; background:#ccc; margin-top:5px;" class="btn">–û—Ç–º–µ–Ω–∞</button>
        </form>
    </div>
</div>

<script>
    function toggleModal(id, show) { document.getElementById(id).style.display = show ? 'block' : 'none'; }
</script>
</body>
</html>